<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>全书网小说内容爬取 | asdfv1929</title>
    <meta name="description" content="This is asdfv1929 &#39;s  blog">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="preload" href="/assets/css/0.styles.b7bc5868.css" as="style"><link rel="preload" href="/assets/js/app.806dfd1e.js" as="script"><link rel="preload" href="/assets/js/7.97edb3cd.js" as="script"><link rel="preload" href="/assets/js/37.08b9b138.js" as="script"><link rel="prefetch" href="/assets/js/1.a7200042.js"><link rel="prefetch" href="/assets/js/10.319aaec7.js"><link rel="prefetch" href="/assets/js/11.4bb85e64.js"><link rel="prefetch" href="/assets/js/12.aeabf8ce.js"><link rel="prefetch" href="/assets/js/13.1994c1f4.js"><link rel="prefetch" href="/assets/js/14.8d0c1330.js"><link rel="prefetch" href="/assets/js/15.e9b3d716.js"><link rel="prefetch" href="/assets/js/16.e56fbcb8.js"><link rel="prefetch" href="/assets/js/17.84ae493d.js"><link rel="prefetch" href="/assets/js/18.2e24a23c.js"><link rel="prefetch" href="/assets/js/19.a4f10f64.js"><link rel="prefetch" href="/assets/js/20.8798d2eb.js"><link rel="prefetch" href="/assets/js/21.3f4b98ee.js"><link rel="prefetch" href="/assets/js/22.7f8cc741.js"><link rel="prefetch" href="/assets/js/23.3838effa.js"><link rel="prefetch" href="/assets/js/24.95a7f706.js"><link rel="prefetch" href="/assets/js/25.9a7b8b82.js"><link rel="prefetch" href="/assets/js/26.c4136c20.js"><link rel="prefetch" href="/assets/js/27.3d7c8852.js"><link rel="prefetch" href="/assets/js/28.481d0563.js"><link rel="prefetch" href="/assets/js/29.26689871.js"><link rel="prefetch" href="/assets/js/3.123d801a.js"><link rel="prefetch" href="/assets/js/30.f05c5529.js"><link rel="prefetch" href="/assets/js/31.bf5213a0.js"><link rel="prefetch" href="/assets/js/32.d7d1f8fa.js"><link rel="prefetch" href="/assets/js/33.0c34af6b.js"><link rel="prefetch" href="/assets/js/34.d10a7934.js"><link rel="prefetch" href="/assets/js/35.adb4d6bc.js"><link rel="prefetch" href="/assets/js/36.58b0719b.js"><link rel="prefetch" href="/assets/js/38.4d490636.js"><link rel="prefetch" href="/assets/js/39.7917ef35.js"><link rel="prefetch" href="/assets/js/4.d52bea1e.js"><link rel="prefetch" href="/assets/js/40.91d56082.js"><link rel="prefetch" href="/assets/js/41.1618df15.js"><link rel="prefetch" href="/assets/js/42.7a8a74c9.js"><link rel="prefetch" href="/assets/js/43.438bbe30.js"><link rel="prefetch" href="/assets/js/44.27125ea0.js"><link rel="prefetch" href="/assets/js/5.6e68ab49.js"><link rel="prefetch" href="/assets/js/6.849e5b0c.js"><link rel="prefetch" href="/assets/js/8.5321f08d.js"><link rel="prefetch" href="/assets/js/9.4568eb7b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b7bc5868.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" data-v-7a046aea><div data-v-e4145d0a data-v-7a046aea><nav class="navbar" data-v-e4145d0a><div class="container" data-v-e4145d0a><a href="/" class="router-link-active" data-v-e4145d0a><span class="navbar-site-name" data-v-e4145d0a>
          asdfv1929
        </span></a> <div class="navbar-toggler" data-v-e4145d0a><svg class="icon" style="font-size:1.2em;" data-v-e4145d0a data-v-e4145d0a><title data-v-e4145d0a data-v-e4145d0a>menu</title><use xlink:href="#icon-menu" data-v-e4145d0a data-v-e4145d0a></use></svg></div> <div class="navbar-links" data-v-e4145d0a><a href="/" class="navbar-link" data-v-e4145d0a>
            Home
          </a><a href="/posts/" class="navbar-link router-link-active" data-v-e4145d0a>
            Posts
          </a><a href="/links/" class="navbar-link" data-v-e4145d0a>
            Links
          </a><a href="/about/" class="navbar-link" data-v-e4145d0a>
            About
          </a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-e4145d0a></div></div> <div class="banner" data-v-98d6aa8c data-v-7a046aea data-v-7a046aea><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-7a046aea>
          全书网小说内容爬取
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-4dd605a1 data-v-4dd605a1><main class="main" data-v-4dd605a1><div class="post" data-v-4dd605a1 data-v-4dd605a1><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      Created : 2018-01-13
    </span> <!----></section> <section class="post-links" data-v-4e23451f><a href="/posts/2018/01/01/life-new-year-2018.html" class="post-link" data-v-4e23451f>
      Previous Post : Happy New Year
    </a> <a href="/posts/2018/01/14/next-git-note.html" class="post-link" data-v-4e23451f>
      Next Post : Git Bash上传项目命令
    </a></section></section> <article class="main-div"><div class="post-content content content__default"><p>本篇主要记录的是关于小说网的简单爬取，并将内容保存至txt文件中。<br></p> <h1 id="前期准备"><a href="#前期准备" class="header-anchor">#</a> 前期准备</h1> <p>准备工作的话，一方面Python语言，另一方面就是几个Python库的使用：requests、bs4等。<br>
关于这些库的具体用法，我这边就不描述了，详细的内容可见官方文档或某些博客：<br>
requests：http://docs.python-requests.org/zh_CN/latest/user/quickstart.html<br>
bs4：https://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html</p> <p>小说网链接：http://www.quanshuwang.com/list/1_1.html</p> <h1 id="小说模型"><a href="#小说模型" class="header-anchor">#</a> 小说模型</h1> <p>我是定义了一个小说类模型，用来存储或操作一篇小说的相关信息。</p> <p>首先是，通过小说的一些数据信息对小说进行初始化：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> author<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> cover<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> desc<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> novel_url<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> chapters_url<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>NovelTitle <span class="token operator">=</span> title    <span class="token comment"># 小说名</span>
    self<span class="token punctuation">.</span>Author <span class="token operator">=</span> author       <span class="token comment"># 小说作者</span>
    self<span class="token punctuation">.</span>CoverImgUrl <span class="token operator">=</span> cover   <span class="token comment"># 封面图片链接</span>
    self<span class="token punctuation">.</span>Desc <span class="token operator">=</span> desc           <span class="token comment"># 小说内容的简短介绍</span>
    self<span class="token punctuation">.</span>NovelUrl <span class="token operator">=</span> novel_url  <span class="token comment"># 小说跳转链接</span>
    self<span class="token punctuation">.</span>ChaptersUrl <span class="token operator">=</span> chapters_url  <span class="token comment"># 小说目录链接</span>
    self<span class="token punctuation">.</span>Chapters <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>         <span class="token comment"># 小说所有章节(chapterTitle, chapterUrl)列表</span>
</code></pre></div><p>之后，我简单定义了一个获取网页源码的方法：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 读取传入参数url的网页源码</span>
    <span class="token keyword">def</span> <span class="token function">readHtml</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">:</span>
        html <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>   <span class="token comment"># 请求url</span>
        html<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'gbk'</span>
        <span class="token keyword">return</span> html<span class="token punctuation">.</span>text
</code></pre></div><p>接着便是获取该小说所有章节的标题及章节链接：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 获取该小说所有章节的(title, url)组成的列表Chapters</span>
    <span class="token keyword">def</span> <span class="token function">getChaptersUrl</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        html <span class="token operator">=</span> self<span class="token punctuation">.</span>readHtml<span class="token punctuation">(</span>self<span class="token punctuation">.</span>ChaptersUrl<span class="token punctuation">)</span>
        soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> chapter <span class="token keyword">in</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;.chapterNum ul li a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>Chapters<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>chapter<span class="token punctuation">.</span>string<span class="token punctuation">,</span> chapter<span class="token punctuation">[</span><span class="token string">'href'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 章节名及链接加入列表</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>Chapters
</code></pre></div><p>最后便是通过章节链接，去访问该章节对应的小说内容，当然，里面还包括了将内容存入本地txt：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 获取该小说某一章节的小说文本内容，并写入文件 chapter: (chapter_title, chapter_url)</span>
    <span class="token keyword">def</span> <span class="token function">getOneChapterContent</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> chapter<span class="token punctuation">)</span><span class="token punctuation">:</span>
        k <span class="token operator">=</span> <span class="token number">0</span>
        obj <span class="token operator">=</span> <span class="token boolean">None</span>
        <span class="token keyword">while</span> k <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">:</span>                                  <span class="token comment"># 容错</span>
            html <span class="token operator">=</span> self<span class="token punctuation">.</span>readHtml<span class="token punctuation">(</span>chapter<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span>
            obj <span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span>attrs<span class="token operator">=</span><span class="token string">&quot;mainContenr&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> obj<span class="token punctuation">:</span>
                <span class="token keyword">break</span>
            k <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> obj<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'None'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        content <span class="token operator">=</span> obj<span class="token punctuation">.</span>text
        content_drop <span class="token operator">=</span> content<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;style5();&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;style6();&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'&lt;br /&gt;'</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">u'\xa0'</span><span class="token punctuation">,</span> <span class="token string">u' '</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">u'\ufffd'</span><span class="token punctuation">,</span> <span class="token string">u' '</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>write2txt<span class="token punctuation">(</span>chapter<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> content_drop<span class="token punctuation">)</span>
</code></pre></div><p>其中，里面有调用了写入文本的方法：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 写入txt，传入章节名和该章节对应的文本内容</span>
    <span class="token keyword">def</span> <span class="token function">write2txt</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> chapter_name<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'Novels/'</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>NovelTitle <span class="token operator">+</span> <span class="token string">'.txt'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>NovelTitle <span class="token operator">+</span> <span class="token string">' 正在写入 '</span> <span class="token operator">+</span> chapter_name<span class="token punctuation">)</span>
            <span class="token builtin">file</span><span class="token punctuation">.</span>writelines<span class="token punctuation">(</span>chapter_name <span class="token operator">+</span> <span class="token string">'\n\n'</span> <span class="token operator">+</span> content <span class="token operator">+</span> <span class="token string">'\n\n'</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="所有小说信息"><a href="#所有小说信息" class="header-anchor">#</a> 所有小说信息</h1> <p>在这边，我主要是获取链接页面中，所有小说的基本信息，例如小说名、作者、封面图片链接、内容简介、跳转链接等。<br>
首先便是，基本的网页源码读取：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 返回页面源码</span>
<span class="token keyword">def</span> <span class="token function">readHtml</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    html <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">)</span>  <span class="token comment"># 请求url</span>
    html<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'gbk'</span>
    <span class="token keyword">return</span> html<span class="token punctuation">.</span>text
</code></pre></div><p>接着是获取该页面上所有小说的基本信息：小说名、作者、封面链接、内容描述、跳转链接，返回信息列表</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 获取小说信息</span>
<span class="token keyword">def</span> <span class="token function">get_novels_info</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    novels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    html <span class="token operator">=</span> readHtml<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> soup<span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;.seeWell li&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        title <span class="token operator">=</span> item<span class="token punctuation">.</span>find<span class="token punctuation">(</span>attrs<span class="token operator">=</span><span class="token string">'clearfix'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text                        <span class="token comment"># 小说名</span>
        author <span class="token operator">=</span> item<span class="token punctuation">.</span>span<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text                        <span class="token comment"># 作者</span>
        coverImg <span class="token operator">=</span> item<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'src'</span><span class="token punctuation">]</span>                              <span class="token comment"># 小说封面链接</span>
        desc <span class="token operator">=</span> item<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'em'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>  <span class="token comment"># 内容描述</span>
        novelUrl <span class="token operator">=</span> item<span class="token punctuation">.</span>span<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'href'</span><span class="token punctuation">]</span>                          <span class="token comment"># 小说跳转链接</span>
        <span class="token comment">#print(title, author, coverImg, desc, novelUrl)</span>
        novel <span class="token operator">=</span> <span class="token punctuation">[</span>title<span class="token punctuation">,</span> author<span class="token punctuation">,</span> coverImg<span class="token punctuation">,</span> desc<span class="token punctuation">,</span> novelUrl<span class="token punctuation">]</span>
        novels<span class="token punctuation">.</span>append<span class="token punctuation">(</span>novel<span class="token punctuation">)</span>
    <span class="token keyword">return</span> novels
</code></pre></div><p>这边是小说信息写入csv文件的方法：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 将小说信息写入csv文件</span>
<span class="token keyword">def</span> <span class="token function">write2csv</span><span class="token punctuation">(</span>novels<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&quot;novels.csv&quot;</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        writer <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> novel <span class="token keyword">in</span> novels<span class="token punctuation">:</span>
            writer<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span>novel<span class="token punctuation">)</span>
</code></pre></div><p>之后便是获取小说跳转至目录的链接，并将该链接也添加至数据信息列表，并返回：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># 获取小说跳转至章节的链接</span>
<span class="token keyword">def</span> <span class="token function">get_chapters_url</span><span class="token punctuation">(</span>novel_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> novel <span class="token keyword">in</span> novel_list<span class="token punctuation">:</span>
        k <span class="token operator">=</span> <span class="token number">0</span>
        obj <span class="token operator">=</span> <span class="token boolean">None</span>
        <span class="token keyword">while</span> k <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">:</span>
            html <span class="token operator">=</span> readHtml<span class="token punctuation">(</span>novel<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>html<span class="token punctuation">,</span> <span class="token string">'html.parser'</span><span class="token punctuation">)</span>
            obj <span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span>attrs<span class="token operator">=</span><span class="token string">&quot;reader&quot;</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> obj<span class="token punctuation">:</span>
                <span class="token keyword">break</span>
            k <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> obj<span class="token punctuation">:</span>
            novel<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
        chapters_url <span class="token operator">=</span> obj<span class="token punctuation">[</span><span class="token string">'href'</span><span class="token punctuation">]</span>
        novel<span class="token punctuation">.</span>append<span class="token punctuation">(</span>chapters_url<span class="token punctuation">)</span>
    <span class="token keyword">return</span> novel_list
</code></pre></div><p>最后便是实例化小说对象，然后获取所有章节链接，之后遍历访问它的小说内容：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">all_chapters_url</span><span class="token punctuation">(</span>novel_list<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> novel <span class="token keyword">in</span> novel_list<span class="token punctuation">:</span>
        a_novel <span class="token operator">=</span> ANovel<span class="token punctuation">(</span>novel<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> novel<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> novel<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> novel<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> novel<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> novel<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 初始化一个novel对象</span>
        a_novel<span class="token punctuation">.</span>getChaptersUrl<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                      <span class="token comment"># 获取该小说对象的所有章节的链接</span>
        <span class="token comment">#print(a_novel.Chapters[:10])                                                 # 打印小说章节列表中的前10章</span>
        <span class="token keyword">for</span> chapter <span class="token keyword">in</span> a_novel<span class="token punctuation">.</span>Chapters<span class="token punctuation">:</span>              <span class="token comment"># 遍历该小说的所有章节</span>
            a_novel<span class="token punctuation">.</span>getOneChapterContent<span class="token punctuation">(</span>chapter<span class="token punctuation">)</span>     <span class="token comment"># 获取某一章节的文本内容</span>
</code></pre></div><h1 id="调用运行"><a href="#调用运行" class="header-anchor">#</a> 调用运行</h1> <p>最后就是在main里调用运行即可：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    url <span class="token operator">=</span> <span class="token string">'http://www.quanshuwang.com/list/1_%s.html'</span>
    <span class="token keyword">for</span> page <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                         <span class="token comment"># range范围可修改</span>
        novelsObjList <span class="token operator">=</span> get_novels_info<span class="token punctuation">(</span>url <span class="token operator">%</span> page<span class="token punctuation">)</span>
        novelsObjList <span class="token operator">=</span> get_chapters_url<span class="token punctuation">(</span>novelsObjList<span class="token punctuation">)</span>
        <span class="token comment"># write2csv(novelsObjList)</span>
        all_chapters_url<span class="token punctuation">(</span>novelsObjList<span class="token punctuation">)</span>
</code></pre></div><p>运行显示：<br> <img src="https://s1.ax1x.com/2018/01/13/pJasC8.png" alt="novel"></p> <p>小说下载：<br> <img src="https://s1.ax1x.com/2018/01/13/pJRGdO.png" alt="pJRGdO.png"></p> <p>附上程序：https://github.com/asdfv1929/QuanshuNetNovelSpider</p></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      Created : 2018-01-13
    </span> <!----></section> <section class="post-links" data-v-4e23451f><a href="/posts/2018/01/01/life-new-year-2018.html" class="post-link" data-v-4e23451f>
      Previous Post : Happy New Year
    </a> <a href="/posts/2018/01/14/next-git-note.html" class="post-link" data-v-4e23451f>
      Next Post : Git Bash上传项目命令
    </a></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-4dd605a1><div class="info-card main-div" data-v-9d847660 data-v-4dd605a1><div class="info-card-header" data-v-9d847660><img src="/img/avatar.jpg" alt="asdfv1929" class="info-avatar" data-v-9d847660></div> <div class="info-card-body" data-v-9d847660><section class="info-nickname" data-v-9d847660>
      asdfv1929
    </section> <section class="info-desc" data-v-9d847660>Hello World</section> <section class="info-contact" data-v-9d847660><section data-v-9d847660><span title="Modu, China" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>Modu, China</title><use xlink:href="#icon-location" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          Modu, China
        </span></span></section> <section data-v-9d847660><span title="Modu" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>Modu</title><use xlink:href="#icon-organization" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          Modu
        </span></span></section> <section data-v-9d847660><a href="mailto:asdfv1929@163.com" title="asdfv1929@163.com" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>asdfv1929@163.com</title><use xlink:href="#icon-email" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          asdfv1929@163.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-9d847660><section class="info-sns clearfix" data-v-9d847660><a href="https://github.com/asdfv1929" target="_blank" class="sns-link" data-v-9d847660><span title="GitHub: asdfv1929" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>GitHub: asdfv1929</title><use xlink:href="#icon-github" data-v-9d847660 data-v-9d847660></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-4dd605a1><!----> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/posts/2018/01/13/spider-quanshu-novel.html#post-comments">
      Comments
    </a></div></div></aside></div> <footer class="footer" data-v-1375e54c><p class="footer-sns-links" data-v-1375e54c><a href="https://github.com/asdfv1929" target="_blank" class="sns-link" data-v-1375e54c><span title="GitHub: asdfv1929" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>GitHub: asdfv1929</title><use xlink:href="#icon-github" data-v-1375e54c data-v-1375e54c></use></svg></span></a></p> <p class="footer-text" data-v-1375e54c><span data-v-1375e54c>Powered by </span> <a href="https://github.com/vuejs/vuepress" target="_blank" data-v-1375e54c>
      VuePress
    </a> <span data-v-1375e54c> | </span> <a href="https://github.com/meteorlxy/vuepress-theme-meteorlxy" target="_blank" data-v-1375e54c>
        meteorlxy
      </a></p> <p class="footer-text" data-v-1375e54c>Copyright 2017-present <a href="https://github.com/asdfv1929" target="_blank">asdfv1929</a></p></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.806dfd1e.js" defer></script><script src="/assets/js/7.97edb3cd.js" defer></script><script src="/assets/js/37.08b9b138.js" defer></script>
  </body>
</html>
